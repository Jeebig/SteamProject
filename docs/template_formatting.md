Рекомендации по предотвращению поломки Django-шаблонов при автоформатировании
=====================================================================

Проблема
-------

VSCode (или его форматтеры — Prettier/Beautify/HTML formatter) иногда переносит
содержимое Django-тега `{% ... %}` на новую строку. Например:

    {% if some_really_long_expression
    %}

Это ломает парсер Django и приводит к TemplateSyntaxError.

Что можно сделать
-----------------

1) Автоматическая починка (уже добавлен скрипт)

   В проекте есть скрипт `scripts/fix_django_template_tags.py`. Он сканирует
   шаблоны и сводит многострочные теги `{% ... %}` в одну строку. Запуск:

       python scripts/fix_django_template_tags.py templates

   Скрипт создаёт резервные копии с расширением `.bak` перед изменением.

2) Настройки редактора (рекомендуется)

   - Откройте настройки VSCode и отключите автоформатирование для HTML/Django-шаблонов
     или установите форматтер, который поддерживает Django-templating.

   Пример в `.vscode/settings.json` (опционально, зависит от используемого форматтера):

   {
     "[html]": {
       "editor.defaultFormatter": "esbenp.prettier-vscode",
       "editor.formatOnSave": false
     },
     "files.associations": {
       "*.html": "django-html"
     }
   }

   Если вы используете Prettier — настройте его так, чтобы он не разбивал атрибуты/теги.

3) Правила написания шаблонов

   - По возможности держите сам тег `{% ... %}` в одной строке.
   - Для длинных выражений вынесите часть логики в view/context или в кастомный
     template tag/filter.

4) Предотвращение в CI (опционально)

   - Можно добавить проверку в CI (скрипт выше) чтобы прервать коммит/CI если
     шаблоны поломаны.

Если хотите, я могу:

- Добавить pre-commit hook, который будет запускать этот скрипт перед коммитом.
- Или применить скрипт ко всем шаблонам сейчас и сделать коммит правок.
